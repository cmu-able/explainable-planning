> library(lme4)> library(lmerTest)> # library(r2glmm) # R squared> library(MuMIn) # R squared> > # setwd("~/Downloads")> data = read.csv("~/Projects/explainable-planning/analysis/data_3qs.csv")> #data = read.csv("~/Projects/explainable-planning/analysis/data_3qs_aligned.csv")> #data = read.csv("~/Projects/explainable-planning/analysis/data_3qs_unaligned.csv")> names(data)[1] "question.ref" "group"        "participant"  "accuracy"     "score"       > > str(data)'data.frame':	297 obs. of  5 variables: $ question.ref: Factor w/ 48 levels "question-mission10-agent0",..: 3 11 43 3 11 43 3 11 43 4 ... $ group       : Factor w/ 2 levels "control","experimental": 1 1 1 1 1 1 1 1 1 1 ... $ participant : Factor w/ 99 levels "A1160COTUR26JZ",..: 82 82 82 27 27 27 9 9 9 60 ... $ accuracy    : num  1 0 0 1 1 0 0 0 0 0 ... $ score       : num  3 -4 -2 3 3 -3 -4 -2 -3 -1 ...> data$accuracy = as.factor(data$accuracy)> table(data$accuracy)  0   1  95 202 > > ## WOW, look at this!> unique(data$group)[1] control      experimentalLevels: control experimental> boxplot(list(control = data[data$group=="control",]$score, +              treatment = data[data$group=="experimental",]$score))> > boxplot(list(control = as.numeric(data[data$group=="control",]$accuracy), +              treatment = as.numeric(data[data$group=="experimental",]$accuracy)))> > > m1 = glmer(accuracy ~ +             group +             + (1|participant) +             + (1|question.ref)+           , family = "binomial"+           , data = data)> > summary(m1) # experimental group are exp(1.3352) = 3.8 times more likely to answer correctly!Generalized linear mixed model fit by maximum likelihood (Laplace Approximation) ['glmerMod'] Family: binomial  ( logit )Formula: accuracy ~ group + (1 | participant) + (1 | question.ref)   Data: data     AIC      BIC   logLik deviance df.resid    354.0    368.7   -173.0    346.0      293 Scaled residuals:     Min      1Q  Median      3Q     Max -2.2136 -0.8926  0.4117  0.6050  1.3082 Random effects: Groups       Name        Variance Std.Dev. participant  (Intercept) 0.1950   0.4416   question.ref (Intercept) 0.5354   0.7317  Number of obs: 297, groups:  participant, 99; question.ref, 48Fixed effects:                  Estimate Std. Error z value Pr(>|z|)    (Intercept)         0.2633     0.2196   1.199    0.231    groupexperimental   1.3352     0.3168   4.215  2.5e-05 ***---Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1Correlation of Fixed Effects:            (Intr)gropxprmntl -0.490> > # R2m: describes the proportion of variance explained by the fixed factor(s) alone> # R2c: describes the proportion of variance explained by both the fixed and random factors> r.squaredGLMM(m1) # goodness of fit of model, without (left) and with (right) random effects                   R2m       R2ctheoretical 0.10009171 0.2635784delta       0.07730201 0.2035647Warning message:The null model is correct only if all variables used by the original model remain unchanged. > > # Doesn't make sense to use ANOVA here since we only have 1 fixed effect> # Instead, report marignal R^2 (R2m) and conditional R^2 (R2c)> anova(m1)Analysis of Variance Table      Df Sum Sq Mean Sq F valuegroup  1 21.229  21.229  21.229> > # Standard error> se <- sqrt(diag(vcov(m1)))> # Table of estimates with 95% CI> tab <- cbind(Est = fixef(m1), LL = fixef(m1) - 1.96 * se, UL = fixef(m1) + 1.96 * se)> exp(tab)                       Est        LL       UL(Intercept)       1.301182 0.8461093 2.001012groupexperimental 3.800738 2.0428191 7.071410> > table(data$score)-4 -3 -2 -1  0  1  2  3  4 27 37 20 11  4 12 28 69 89 > > m2 = lmer(score ~ +              group +            + (1|participant) +            + (1|question.ref)+            , data = data)> > summary(m2)Linear mixed model fit by REML. t-tests use Satterthwaite's method ['lmerModLmerTest']Formula: score ~ group + (1 | participant) + (1 | question.ref)   Data: dataREML criterion at convergence: 1449.4Scaled residuals:     Min      1Q  Median      3Q     Max -2.3169 -0.7789  0.3275  0.6548  1.7601 Random effects: Groups       Name        Variance Std.Dev. participant  (Intercept) 0.9652   0.9824   question.ref (Intercept) 0.7534   0.8680   Residual                 6.2678   2.5036  Number of obs: 297, groups:  participant, 99; question.ref, 48Fixed effects:                  Estimate Std. Error      df t value Pr(>|t|)    (Intercept)         0.3408     0.2794 96.9906   1.220    0.226    groupexperimental   1.7271     0.3514 76.4749   4.915 4.94e-06 ***---Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1Correlation of Fixed Effects:            (Intr)gropxprmntl -0.635> r.squaredGLMM(m2)            R2m       R2c[1,] 0.08565657 0.2824203> > # Doesn't make sense to use ANOVA here since we only have 1 fixed effect> # Instead, report marignal R^2 (R2m) and conditional R^2 (R2c)> anova(m2)Type III Analysis of Variance Table with Satterthwaite's method      Sum Sq Mean Sq NumDF  DenDF F value    Pr(>F)    group 151.41  151.41     1 76.475  24.156 4.945e-06 ***---Signif. codes:  0 ‘***’ 0.001 ‘**’ 0.01 ‘*’ 0.05 ‘.’ 0.1 ‘ ’ 1